<!--
	outer loop
	Take next picture out of queue.
	Set div height to maximum we ever want.

	Loop
	Is the div wider than the screen width?

		yes 
			apply a scaling factor to the div to exactly fit the window.  start outer loop
		no
			add another picture to the line.  Start inner loop




w1 + w2 + w3 = W

x = w/h
w = xh

hx1 + hx2 + hx3 = W

h = W / (x1 +x2 + x3)

-->






<head>
	<h1>alex|smith</h1>
	<a href="#">portfolio</a>
	<a href="#">about</a>
	<a href="#">contact</a>
	<style>
		img {
    		/*max-width: 100%;
    		max-height: 100%;*/
    		padding-left: 0px;
    		padding-right: 0px;
    		padding-bottom: 0px; 
    		border:5px;
		}
		section{
			/*padding-right: 20px*/ 
		}
	</style>
</head>

<section id = "photos">
	<!--div id="cur" style="height: 500px"></div-->
	<img src="img/fed/header.jpg">
	<img src="img/fed/DSC00003.jpg">
	<img src="img/fed/DSC00019.jpg">
	<img src="img/fed/DSC00073.jpg">
	<img src="img/fed/DSC00195.jpg">
	<img src="img/fed/DSC00243.jpg">
	<img src="img/fed/DSC00245.jpg">
</section>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>

	/*$(window).resize(function(){
		sort_pics()
	});*/

	$(window).on("load", function(){
		sort_pics()
	});



	function sort_pics(){

		var max_line_height = 600



		var window_width = $(window).width()-25 //note: 16 appears to be the base amount of padding.  Just on Chrome?

		var img_list = []
		var aspect_ratio_sum = 0
		var line_height = max_line_height
		var fudge_image_padding = 0 //on lines that have two or more pictures, there is a 1 px border around, so 2 px between them


		console.log("window.  width="+window_width)

		$('#photos img').each(function () {
			
			var img_width = $(this).width()
			var img_height = $(this).height()
			console.log("image.  width="+img_width+" height="+img_height)

			if(img_height < line_height){line_height = img_height} //div shouldn't be taller than the maximum of the picture's height or the height I set
			aspect_ratio_sum += (img_width/img_height) //save aspect ratio sum for scaling the div once we find out it's getting wider than the window.
			img_list.push($(this))

			var cur_line_height = (window_width-fudge_image_padding*2.0*img_list.length)/aspect_ratio_sum

			//cur_line_height = window_width/img_width*img_height
			

			if(cur_line_height < line_height){ //calculated height of window less than maximum
				console.log("new line with height="+cur_line_height)
				if (img_list.length ==1 ) {
					//edge case handling
					img_list[0].css("padding-bottom","4")
					cur_line_height+=fudge_image_padding
				}
				for(i = 0; i < img_list.length; i++){
					img_list[i].height(parseInt(cur_line_height))
					//img_list[i].width(img_list[i].width()/line_height*cur_line_height)
				}
				img_list = []
				aspect_ratio_sum = 0
				line_height = max_line_height

			}
			
	    });
	}
</script>