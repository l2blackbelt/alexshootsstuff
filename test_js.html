<!--
	outer loop
	Take next picture out of queue.
	Set div height to maximum we ever want.

	Loop
	Is the div wider than the screen width?

		yes 
			apply a scaling factor to the div to exactly fit the window.  start outer loop
		no
			add another picture to the line.  Start inner loop




w1 + w2 + w3 = W

x = w/h
w = xh

hx1 + hx2 + hx3 = W

h = W / (x1 +x2 + x3)

-->






<head>
	<h1>alex|smith</h1>
	<a href="#">portfolio</a>
	<a href="#">about</a>
	<a href="#">contact</a>
	<style>
		img {
    		/*max-width: 100px;
    		max-height: 100px;
    		display: block;
    		-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box; 
			box-sizing: border-box;     
    		padding: 5px*/
		}
		section{
			font-size: 0; /*necessary to prevent unwanted gaps in the photos*/
			padding-left: 40;
			padding-right: 40;
		}
	</style>
</head>

<section id = "photos">
	<!--div id="cur" style="height: 500px"></div-->
	<img src="img/fed/header.jpg">
	<img src="img/fed/DSC00003.jpg">
	<img src="img/fed/DSC00019.jpg">
	<img src="img/fed/DSC00073.jpg">
	<img src="img/fed/DSC00195.jpg">
	<img src="img/fed/DSC00243.jpg">
	<img src="img/fed/DSC00245.jpg">
</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>

	$(window).resize(function(){
		//sort_pics()
	});

	var pic_array = []

	$(window).on("load", function(){
		create_pic_array()
		sort_pics()
	});

	function create_pic_array(){
		$('#photos img').each(function () {
			var pic = new picture($(this),$(this).width(),$(this).height())
			pic_array.push(pic)
		});

		function picture(src, width, height) {
			this.src = src;
		  	this.width = width;
		  	this.height = height;
		  	this.ratio = width/height;
		}
		console.log(pic_array.length)

	}


	function sort_pics(){


		function line(window_width) { //line object represents a line of images on the screen
			this.maxheight = 600
			this.padding = 0

			this.width = window_width
			this.imgs = []
		  	this.ratiosum = 0
		  	this.height = 999999
		  	this.add_img = function(img){
		  		this.imgs.push(img)
		  		this.ratiosum += img.ratio
		  		this.height = this.width/this.ratiosum
		  		this.maxheight = Math.min(img.height,this.maxheight)
		  	}
		  	this.am_i_properly_sized = function(){
		  		return (this.height < this.maxheight)
		  	}
		  	this.fit_line_to_window = function(){
		  		var scaled_image_width = 0 //find out what the image was actually scaled to.  To get pixel perfect edges we will need to fudge the width of a picture per line
		  		for(j = 0; j < this.imgs.length; j++){
					this.imgs[j].src.height(this.height)
					this.imgs[j].src.width(this.height*this.imgs[j].ratio) //there's still more work I can do refactoring this code. why need to store copies of all the picture structure in the new array?
					scaled_image_width += this.imgs[j].src.width()
					//console.log("image with width="+this.imgs[j].src.width())
				}
				this.imgs[0].src.width(this.imgs[0].src.width()-(scaled_image_width-this.width)) //fudging the scaling of one image per line to get pixel perfect right edge.
		  	}
		  	this.scale_line_height_to_value = function(val){
		  		for(j = 0; j < this.imgs.length; j++){
					this.imgs[j].src.height(val)
				}
		  	}
		}

		//master variables
		var max_line_height = 600
		var img_padding = 5
		var window_width = $("#photos").width() //note: 16 appears to be the default margin size  Just on Chrome?

		//console.log("window.  width="+window_width)

		var cur_line = new line(window_width)
		for(i = 0; i < pic_array.length; i++){
			console.log("i= "+i)

			cur_line.add_img(pic_array[i])
			console.log("added img")

			if(cur_line.am_i_properly_sized()){ //calculated height of window less than maximum

				cur_line.fit_line_to_window()
				var cur_line = new line(window_width)
				console.log("scaled")
			}
			
	    }
	    cur_line.scale_line_height_to_value(cur_line.maxheight*.8) //fit any straggling lines that aren't fit to the window

	}
</script>